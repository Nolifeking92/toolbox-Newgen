rule SuspiciousPatterns
{
    meta:
        description = "Détection de patterns suspects dans les fichiers"
        author = "Toolbox Newgen"
        date = "2024"
        
    strings:
        // Commandes système suspectes
        $cmd1 = "cmd.exe" nocase
        $cmd2 = "powershell" nocase
        $cmd3 = "rundll32" nocase
        
        // Connexions réseau suspectes
        $net1 = "http://" nocase
        $net2 = "https://" nocase
        $net3 = "socket" nocase
        
        // Comportements suspects
        $susp1 = "CreateRemoteThread" nocase
        $susp2 = "VirtualAlloc" nocase
        $susp3 = "WriteProcessMemory" nocase
        
        // Registre Windows
        $reg1 = "CurrentVersion\\Run" nocase
        $reg2 = "HKEY_LOCAL_MACHINE" nocase
        
    condition:
        // Le fichier contient au moins 3 patterns suspects
        3 of them
} 